{"version":3,"file":"dynamicMap.js","sources":["../../src/javascript/src/common/drupal/drupal.js","../../src/javascript/src/dynamicMap/src/DynamicMap.js","../../src/javascript/src/dynamicMap/dynamicMap.js"],"sourcesContent":["export let T = {\n    /**\n     * Renvoie vrai si le context est root (document)\n     * @param context\n     */\n    contextIsRoot: function( context){\n        return 'HTML' === context.children[0].tagName;\n    },\n    /**\n     * Retourne vrai si la variable est définie.\n     * @param variable\n     * @returns {boolean}\n     */\n    isDefined: function (variable) {\n        return 'undefined' !== typeof variable;\n    },\n    /**\n     * Retourne la taille de la fenêtre dans un objet avec .width et .height\n     * @returns object\n     */\n    viewport: function () {\n        var e = window, a = 'inner';\n        if (!('innerWidth' in window )) {\n            a = 'client';\n            e = document.documentElement || document.body;\n        }\n        return { width : e[ a+'Width' ] , height : e[ a+'Height' ]};\n    }\n};\nexport let DrupalHelpers = {\n    getBasePath() {\n        return drupalSettings.path.baseUrl + drupalSettings.path.pathPrefix;\n    }\n};","import { T } from \"../../common/drupal/drupal\";\n\nclass DynamicMap {\n\n\n    init(context) {\n\n        const paragraphs = context.querySelectorAll(\".ParagraphDynamicMap-slides\");\n\n        const sliders = [];\n        paragraphs.forEach((paragraph) => {\n            const length = paragraph.querySelectorAll(\".TermDestinationDynamicMap\").length;\n\n            const swiper = new Swiper(paragraph, {\n                loop: true,\n                navigation: {\n                    nextEl: paragraph.querySelector('.swiper-button-next'),\n                    prevEl: paragraph.querySelector('.swiper-button-prev'),\n                }\n            });\n\n\n            const $allDestinationLinks = paragraph.closest(\".ParagraphDynamicMap-content\")?.querySelectorAll(\"a.DynamicMap-link\");\n            $allDestinationLinks?.forEach(($destinationLink) => {\n                $destinationLink.addEventListener(\"click\", function (e) {\n                    e.preventDefault();\n                    const slideToFocus = paragraph.querySelector(`.TermDestinationDynamicMap[data-destination=\"${$destinationLink.getAttribute(\"href\").substring(1)}\"]`);\n                    swiper.slideTo(parseInt(slideToFocus.getAttribute(\"data-swiper-slide-index\")) + 1);\n\n                });\n            });\n\n            swiper.on('activeIndexChange', function () {\n                const activeSlide = this.slides[this.realIndex + 1];\n                let activeDestination = activeSlide.getAttribute('data-destination');\n                const paragraphParent = paragraph.closest(\".ParagraphDynamicMap-content\");\n                const destinationLink = paragraphParent.querySelector(`a[*|href=\"#${activeDestination}\"]`);\n                let allDestinationLinks = destinationLink.parentNode.querySelectorAll(\"a\");\n                allDestinationLinks.forEach((aDestinationLink) => {\n                    aDestinationLink.classList.remove(\"is-active\");\n                })\n                destinationLink.classList.add('is-active');\n            });\n\n            let randomSlideIndex = this.getRandomArbitrary(1, length + 1);\n            \n            swiper.slideTo(randomSlideIndex);\n            if(randomSlideIndex === 1) {\n                const activeSlide = swiper.slides[1];\n                let activeDestination = activeSlide.getAttribute('data-destination');\n                const paragraphParent = paragraph.closest(\".ParagraphDynamicMap-content\");\n                const destinationLink = paragraphParent.querySelector(`a[*|href=\"#${activeDestination}\"]`);\n                let allDestinationLinks = destinationLink.parentNode.querySelectorAll(\"a\");\n                allDestinationLinks.forEach((aDestinationLink) => {\n                    aDestinationLink.classList.remove(\"is-active\");\n                })\n                destinationLink.classList.add('is-active');\n            }\n            sliders.push(swiper);\n\n        });\n    }\n\n    getRandomArbitrary(min, max) {\n        min = Math.ceil(min);\n        max = Math.floor(max);\n        return Math.floor(Math.random() * (max - min)) + min;\n    }\n\n\n    attach(context, settings) {\n        if (T.contextIsRoot(context)) {\n            this.init(context);\n        }\n    }\n}\n\nexport let dynamicMap = new DynamicMap();","import {dynamicMap} from \"./src/DynamicMap\";\n\n(function (Drupal) { // closure\n    'use strict';\n    Drupal.behaviors.dynamicMap = dynamicMap;\n}(Drupal));\n"],"names":["T","contextIsRoot","context","children","tagName","isDefined","variable","viewport","e","window","a","document","documentElement","body","width","height","DynamicMap","paragraphs","querySelectorAll","forEach","paragraph","length","swiper","Swiper","loop","navigation","nextEl","querySelector","prevEl","$allDestinationLinks","closest","$destinationLink","addEventListener","preventDefault","slideToFocus","getAttribute","substring","slideTo","parseInt","on","activeSlide","slides","realIndex","activeDestination","paragraphParent","destinationLink","allDestinationLinks","parentNode","aDestinationLink","classList","remove","add","randomSlideIndex","getRandomArbitrary","min","max","Math","ceil","floor","random","settings","init","dynamicMap","Drupal"],"mappings":"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"}